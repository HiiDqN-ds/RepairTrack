<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Print Ticket {{ ticket.tracking_id }}</title>
    <link rel="shortcut icon" href="repair_system/static/favicon.ico" type="image/x-icon">

    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Include JsBarcode -->
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>

    <style>
        /* Thermal receipt size: 56mm x 104mm */
        @page {
            size: 56mm 104mm;
            margin: 2mm;
        }

        body {
            font-family: sans-serif;
            font-size: 12px;
            width: 56mm;
            margin: 0;
            padding: 6px;
            -webkit-print-color-adjust: exact;
            -moz-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        .ticket {
            width: 100%;
            padding: 4px;
            border: 1px solid #000;
            border-radius: 6px;
        }

        .text-center {
            text-align: center;
        }

        .barcode-container {
            display: flex;
            justify-content: center;
            margin: 10px 0;
        }

        .no-print {
            display: none;
        }

        @media print {
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body>

<div class="ticket">
    <h2 class="text-2xl font-bold mb-2 text-center">Repair Ticket</h2>

    <div class="mb-1"><strong>Tracking ID:</strong> {{ ticket.tracking_id }}</div>
    <div class="mb-1"><strong>Client:</strong> {{ ticket.client.first_name }} {{ ticket.client.last_name }}</div>
    <div class="mb-1"><strong>Phone:</strong> {{ ticket.client_phone|default:"N/A" }}</div>
    <div class="mb-1"><strong>Device:</strong> {{ ticket.device_type }} â€“ {{ ticket.device_model }}</div>
    <div class="mb-1"><strong>Status:</strong> {{ ticket.status|title }}</div>
    <div class="mb-1"><strong>Created:</strong> {{ ticket.created_at|date:"Y-m-d H:i" }}</div>

    <!-- Barcode -->
    <div class="barcode-container">
        <svg id="barcode"></svg>
    </div>

    <div class="mt-2 text-center no-print">
        <button onclick="window.print()"
            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition">
            Print
        </button>
    </div>
</div>

<script>
    // Generate the barcode using the tracking ID
    JsBarcode("#barcode", "{{ ticket.tracking_id }}", {
        format: "CODE128",
        lineColor: "#000",
        width: 2,
        height: 50,
        displayValue: true,
        textAlign: "center"
    });
</script>

</body>
</html>
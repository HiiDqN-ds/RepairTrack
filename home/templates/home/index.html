<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tanitech Services</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"/>

    <style>
        body { scroll-behavior: smooth; }
        @keyframes shake {0%,100%{transform:translateX(0);}20%,60%{transform:translateX(-5px);}40%,80%{transform:translateX(5px);} }
        .animate-shake { animation: shake 0.3s; }
        #ticketModal .translate-y-10 { transform: translateY(2.5rem); }
        #ticketModal.opacity-100 { opacity: 1; }
        #ticketModal.translate-y-0 { transform: translateY(0); }
    </style>
</head>
<body class="font-sans text-gray-700">

<!-- Header -->
<header class="bg-white shadow fixed w-full z-50">
    <div class="container mx-auto flex justify-between items-center p-4">
        <a href="#hero" class="flex items-center">
            <img src="https://img.icons8.com/?size=100&id=61238&format=png&color=000000" alt="Tanitech Logo" class="h-12 w-auto mr-3">
            <span class="text-2xl font-bold text-blue-600">Tanitech</span>
        </a>
        <nav class="space-x-6">
            <a href="#services" class="hover:text-blue-600">Services</a>
            <a href="#contact" class="hover:text-blue-600">Contact</a>
            <button id="openTrackModal" class="hover:text-blue-600 font-semibold">Track Repair</button>
        </nav>
    </div>
</header>

<!-- Hero Slider -->
<section id="hero" class="relative h-screen">
    <div class="swiper h-full">
        <div class="swiper-wrapper h-full">
            <div class="swiper-slide bg-[url('https://images.unsplash.com/photo-1581090462497-4fefb3c1b6d0?auto=format&fit=crop&w=1470&q=80')] bg-center bg-cover flex flex-col justify-center items-center text-white text-center px-4">
                <div class="absolute inset-0 bg-black/40"></div>
                <div class="relative z-10 animate-fadeIn">
                    <h2 class="text-4xl sm:text-5xl md:text-6xl font-bold drop-shadow-lg">Fast & Reliable Device Repair</h2>
                    <p class="mt-4 text-lg sm:text-xl md:text-2xl drop-shadow-lg">Phones, Laptops, Tablets – We Fix Them All</p>
                    <a href="javascript:void(0)" class="mt-8 inline-block bg-blue-600 px-6 py-3 rounded-lg text-white font-semibold hover:bg-blue-700 transition openModalBtn">Open a Repair Ticket</a>
                </div>
            </div>
            <div class="swiper-slide bg-[url('https://images.unsplash.com/photo-1612831660427-ff6d9e4c8b38?auto=format&fit=crop&w=1470&q=80')] bg-center bg-cover flex flex-col justify-center items-center text-white text-center px-4">
                <div class="absolute inset-0 bg-black/40"></div>
                <div class="relative z-10 animate-fadeIn">
                    <h2 class="text-4xl sm:text-5xl md:text-6xl font-bold drop-shadow-lg">Expert Laptop Repairs</h2>
                    <p class="mt-4 text-lg sm:text-xl md:text-2xl drop-shadow-lg">We fix hardware, software, and virus issues fast.</p>
                    <a href="javascript:void(0)" class="mt-8 inline-block bg-blue-600 px-6 py-3 rounded-lg text-white font-semibold hover:bg-blue-700 transition openModalBtn">Book Now</a>
                </div>
            </div>
            <div class="swiper-slide bg-[url('https://images.unsplash.com/photo-1601050690571-8cbd1a89b38b?auto=format&fit=crop&w=1470&q=80')] bg-center bg-cover flex flex-col justify-center items-center text-white text-center px-4">
                <div class="absolute inset-0 bg-black/40"></div>
                <div class="relative z-10 animate-fadeIn">
                    <h2 class="text-4xl sm:text-5xl md:text-6xl font-bold drop-shadow-lg">Professional Device Diagnostics</h2>
                    <p class="mt-4 text-lg sm:text-xl md:text-2xl drop-shadow-lg">We find the problem quickly and accurately.</p>
                    <a href="javascript:void(0)" class="mt-8 inline-block bg-blue-600 px-6 py-3 rounded-lg text-white font-semibold hover:bg-blue-700 transition openModalBtn">Get Started</a>
                </div>
            </div>
        </div>
        <div class="swiper-pagination"></div>
    </div>
</section>

<!-- Services -->
<section id="services" class="py-20 bg-gray-50">
    <div class="container mx-auto text-center">
        <h2 class="text-3xl font-bold mb-12">Our Services</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-8">
            <div class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition flex flex-col items-center">
                <img class="mx-auto" src="https://img.icons8.com/ios-filled/100/000000/iphone.png"/>
                <h3 class="text-xl font-semibold mt-4">Phone Repair</h3>
                <p class="mt-2 text-gray-600">Screen, battery, water damage and more.</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition flex flex-col items-center">
                <img class="mx-auto" src="https://img.icons8.com/ios-filled/100/000000/laptop.png"/>
                <h3 class="text-xl font-semibold mt-4">Laptop Repair</h3>
                <p class="mt-2 text-gray-600">Hardware, software, and virus removal.</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition flex flex-col items-center">
                <img class="mx-auto" src="https://img.icons8.com/?size=100&id=11087&format=png&color=000000"/>
                <h3 class="text-xl font-semibold mt-4">Tablet Repair</h3>
                <p class="mt-2 text-gray-600">Screen, battery, and performance issues.</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition flex flex-col items-center">
                <img class="mx-auto" src="https://img.icons8.com/?size=100&id=61238&format=png&color=000000"/>
                <h3 class="text-xl font-semibold mt-4">Diagnostics</h3>
                <p class="mt-2 text-gray-600">We find the problem quickly and accurately.</p>
            </div>
        </div>
    </div>
</section>

<!-- Contact -->
<section id="contact" class="py-20 bg-gray-50">
    <div class="container mx-auto text-center max-w-2xl">
        <h2 class="text-3xl font-bold mb-6">Contact Us</h2>
        <p class="mb-2"><strong>Phone:</strong> +49(0)15904000040</p>
        <p class="mb-2"><strong>Email:</strong> info@tanitech.de</p>
        <p class="mb-6"><strong>Address:</strong> Friedrichstraße 1, 40217 Düsseldorf</p>
        <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d4998.064672361595!2d6.77416171165504!3d51.21847997163125!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47b8cb00589fda85%3A0x621f4d007f0419c9!2sTaniTech%20-%20Mobile%20und%20PC%20Reparatur%20Services!5e0!3m2!1sfr!2sde!4v1768835626024!5m2!1sfr!2sde"
            width="100%" height="300" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
    </div>
</section>

<!-- Footer -->
<footer class="bg-blue-600 text-white text-center p-6">
    &copy; 2026 Tanitech. All rights reserved.
</footer>


<!-- Tracking Modal -->
<div id="trackModal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50 p-4 opacity-0 transition-opacity duration-300">
  <div class="bg-white rounded-xl shadow-xl w-full max-w-md p-6 transform translate-y-10 transition-transform duration-300">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-bold">Track Your Repair</h2>
      <button id="closeTrackModal" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
    </div>
    <p class="mb-4 text-gray-700">Enter your tracking number to see the current status of your repair.</p>

    <form id="trackForm" class="flex flex-col gap-3">
      <input type="text" id="trackingInput" placeholder="Tracking Number" class="border rounded p-3 focus:ring-2 focus:ring-blue-400">
      <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Check Status</button>
    </form>

    <div id="trackResult" class="mt-4 hidden p-4 rounded bg-gray-100 text-gray-800"></div>
  </div>
</div>





<!-- Modal -->
<div id="ticketModal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50 p-4 opacity-0 transition-opacity duration-300">
  <div class="bg-white rounded-xl shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto relative transform translate-y-10 transition-transform duration-300">
    <div class="sticky top-0 bg-white p-4 flex justify-between items-center border-b z-10">
      <h2 class="text-xl font-bold">Neuen Reparaturauftrag erstellen</h2>
      <button id="closeModal" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
    </div>

    <form id="ticketFormModal" class="p-4 space-y-4" enctype="multipart/form-data">
      <input name="client_name" id="client_name" type="text" placeholder="Name" class="w-full p-3 border rounded focus:ring-2 focus:ring-blue-400">
      <p class="text-red-600 text-sm hidden" id="error-client_name"></p>

      <input name="client_email" id="client_email" type="email" placeholder="Email" class="w-full p-3 border rounded focus:ring-2 focus:ring-blue-400">
      <p class="text-red-600 text-sm hidden" id="error-client_email"></p>

      <input name="client_phone" id="client_phone" type="text" placeholder="Telefon" class="w-full p-3 border rounded focus:ring-2 focus:ring-blue-400">

      <select name="device_type" id="device_type" class="w-full p-3 border rounded focus:ring-2 focus:ring-blue-400">
        <option value="">Gerät auswählen</option>
        <option value="Smartphone">Smartphone</option>
        <option value="Tablet">Tablet</option>
        <option value="Laptop">Laptop</option>
      </select>
      <p class="text-red-600 text-sm hidden" id="error-device_type"></p>

      <input name="device_model" id="device_model" type="text" placeholder="Modell" class="w-full p-3 border rounded focus:ring-2 focus:ring-blue-400">

      <textarea name="problem_description" id="problem_description" placeholder="Problem" class="w-full p-3 border rounded focus:ring-2 focus:ring-blue-400"></textarea>

      <input name="estimated_price" id="estimated_price" type="number" placeholder="Preis (€)" class="w-full p-3 border rounded focus:ring-2 focus:ring-blue-400">

      <label class="block text-gray-700 font-medium">Gerätefoto (optional)</label>
      <div class="flex items-center gap-2">
        <input name="device_photo" id="device_photo" type="file" accept="image/*" class="flex-1 p-2 border rounded">
        <button type="button" id="removePhoto" class="text-red-500 hover:text-red-700 font-semibold hidden">X</button>
      </div>
      <img id="previewPhoto" class="mt-2 max-h-40 rounded hidden" />

      <button type="submit" class="w-full bg-blue-600 text-white p-3 rounded hover:bg-blue-700 flex justify-center items-center gap-2">
        Absenden
        <svg id="spinner" class="animate-spin h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path>
        </svg>
      </button>

      <p id="responseMessage" class="mt-2 text-center font-semibold"></p>
      <div id="progressBar" class="h-1 bg-green-500 w-0 transition-all"></div>
    </form>
  </div>
</div>

<!-- Toast -->
<div id="toast" class="fixed bottom-5 right-5 bg-gray-800 text-white px-4 py-3 rounded shadow-lg opacity-0 transition-opacity duration-300 z-50"></div>

<!-- Swiper JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>

<!-- JS -->

<!-- JS -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  // ---------------- Ticket Modal ----------------
  const modal = document.getElementById('ticketModal');
  const openBtns = document.querySelectorAll('.openModalBtn');
  const closeBtn = document.getElementById('closeModal');
  const form = document.getElementById('ticketFormModal');
  const toast = document.getElementById('toast');
  const spinner = document.getElementById('spinner');
  const progressBar = document.getElementById('progressBar');
  const previewPhoto = document.getElementById('previewPhoto');
  const removePhoto = document.getElementById('removePhoto');
  const responseMessage = document.getElementById('responseMessage');

  // Modal open/close
  openBtns.forEach(btn => btn.onclick = () => { 
    modal.classList.remove('hidden'); 
    setTimeout(() => modal.classList.add('opacity-100','translate-y-0'),10); 
  });
  closeBtn.onclick = () => { 
    modal.classList.remove('opacity-100','translate-y-0'); 
    setTimeout(() => modal.classList.add('hidden'),300); 
  };
  modal.addEventListener('click', e => { if(e.target === modal) closeBtn.onclick(); });
  document.addEventListener('keydown', e => { if(e.key==='Escape' && !modal.classList.contains('hidden')) closeBtn.onclick(); });

  // Image preview
  document.getElementById('device_photo').addEventListener('change', e => {
    if(e.target.files[0]){
      previewPhoto.src = URL.createObjectURL(e.target.files[0]);
      previewPhoto.classList.remove('hidden');
      removePhoto.classList.remove('hidden');
    } else {
      previewPhoto.classList.add('hidden');
      removePhoto.classList.add('hidden');
    }
  });
  removePhoto.addEventListener('click', () => {
    document.getElementById('device_photo').value = '';
    previewPhoto.classList.add('hidden');
    removePhoto.classList.add('hidden');
  });

  // Validation fields
  const fields = [
    { id: 'client_name', message: 'Name erforderlich' },
    { id: 'client_email', message: 'Email erforderlich' },
    { id: 'device_type', message: 'Gerät auswählen' }
  ];

  function showError(id,msg){ 
    const input = document.getElementById(id); 
    const error = document.getElementById(`error-${id}`); 
    input.classList.add('border-red-500','animate-shake'); 
    setTimeout(() => input.classList.remove('animate-shake'),300); 
    error.innerText = msg; 
    error.classList.remove('hidden'); 
  }
  function clearError(id){ 
    const input = document.getElementById(id); 
    const error = document.getElementById(`error-${id}`); 
    input.classList.remove('border-red-500'); 
    error.classList.add('hidden'); 
  }
  function showToast(msg,bg='bg-gray-800'){ 
    toast.textContent = msg; 
    toast.className = `fixed bottom-5 right-5 px-4 py-3 rounded shadow-lg opacity-100 ${bg} transition-opacity duration-300 z-50`; 
    setTimeout(() => toast.classList.add('opacity-0'),3000); 
  }

  fields.forEach(f => {
    const input = document.getElementById(f.id);
    input.addEventListener('input', () => { 
      if(input.value.trim()) clearError(f.id); 
      else showError(f.id,f.message); 
    });
  });

  // Ticket form submission
  form.addEventListener('submit', async e => {
    e.preventDefault();
    let firstInvalid = null;
    fields.forEach(f => {
      if(!document.getElementById(f.id).value.trim()){ 
        showError(f.id,f.message); 
        if(!firstInvalid) firstInvalid = document.getElementById(f.id); 
      }
    });
    if(firstInvalid){ firstInvalid.focus(); return; }

    spinner.classList.remove('hidden');
    progressBar.style.width='0%';
    let width=0;
    const interval=setInterval(()=>{ width+=10; progressBar.style.width=width+'%'; if(width>=90) clearInterval(interval); },50);

    const formData = new FormData(form);

    try{
      const res = await fetch('/api/tickets/', {method:'POST', body:formData});
      const data = await res.json();

      clearInterval(interval);
      progressBar.style.width='100%';
      spinner.classList.add('hidden');

      if(res.ok){
        showToast("✅ Auftrag erfolgreich!",'bg-green-600');
        responseMessage.innerHTML = `✅ Auftrag erfolgreich eingereicht!<br>Tracking #: <span class="font-bold">${data.tracking_id}</span>`;
        responseMessage.className = "text-green-600 font-semibold text-center";
        form.reset(); 
        previewPhoto.classList.add('hidden'); 
        removePhoto.classList.add('hidden');
      } else showToast("❌ "+(data.error||"Fehler"),'bg-red-600');

    } catch {
      spinner.classList.add('hidden');
      showToast("❌ Netzwerkfehler",'bg-red-600');
    }
  });

  // ---------------- Tracking Modal ----------------
  const trackModal = document.getElementById('trackModal');
  const openTrackBtn = document.getElementById('openTrackModal');
  const closeTrackBtn = document.getElementById('closeTrackModal');
  const trackForm = document.getElementById('trackForm');
  const trackResult = document.getElementById('trackResult');
  const trackingInput = document.getElementById('trackingInput');

  // Open/close tracking modal
  openTrackBtn.onclick = () => {
    trackModal.classList.remove('hidden');
    setTimeout(() => trackModal.classList.add('opacity-100','translate-y-0'),10);
  };
  closeTrackBtn.onclick = () => {
    trackModal.classList.remove('opacity-100','translate-y-0');
    setTimeout(() => trackModal.classList.add('hidden'),300);
    trackResult.classList.add('hidden');
    trackResult.innerHTML = '';
    trackingInput.value = '';
  };
  trackModal.addEventListener('click', e => { if(e.target === trackModal) closeTrackBtn.onclick(); });

  // Submit tracking form
  trackForm.addEventListener('submit', async e => {
    e.preventDefault();
    const trackingId = trackingInput.value.trim();
    if(!trackingId) return alert("Please enter a tracking number.");

    trackResult.classList.remove('hidden');
    trackResult.innerHTML = "Loading...";

    try {
      const res = await fetch(`/api/tickets/${trackingId}/`);
      const data = await res.json();

      if(res.ok){
        trackResult.innerHTML = `
          <p><strong>Tracking #: </strong>${data.tracking_id}</p>
          <p><strong>Status: </strong>${data.status}</p>
          <p><strong>Device: </strong>${data.device_type} – ${data.device_model}</p>
          <p><strong>Description: </strong>${data.description}</p>
        `;
      } else {
        trackResult.innerHTML = `<p class="text-red-600">${data.error || "Ticket not found."}</p>`;
      }
    } catch(err){
      trackResult.innerHTML = `<p class="text-red-600">Network error, please try again.</p>`;
    }
  });

  // ---------------- Swiper Slider Initialization ----------------
  const swiper = new Swiper('.swiper', {
    loop: true,
    autoplay: {
      delay: 5000,
      disableOnInteraction: false,
    },
    pagination: {
      el: '.swiper-pagination',
      clickable: true,
    },
    effect: 'slide', // can change to 'fade', 'cube', etc.
  });

});
</script>
</body>
</html>
